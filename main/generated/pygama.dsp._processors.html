<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygama.dsp._processors package &mdash; pygama  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygama.evt package" href="pygama.evt.html" />
    <link rel="prev" title="pygama.dsp package" href="pygama.dsp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pygama
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials (Jupyter notebooks)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Package API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pygama.html">pygama package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pygama.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="pygama.dsp.html">pygama.dsp package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.evt.html">pygama.evt package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.flow.html">pygama.flow package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.hit.html">pygama.hit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.lgdo.html">pygama.lgdo package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.math.html">pygama.math package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.pargen.html">pygama.pargen package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.raw.html">pygama.raw package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.vis.html">pygama.vis package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#module-pygama.cli">pygama.cli module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer's guide</a></li>
</ul>

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: main
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Branches</dt>
          <dd><a href="pygama.dsp._processors.html">main</a></dd>
          <dd><a href="../../refactor/index.html">refactor</a></dd>
          <dd><a href="../../releases/v0.9/index.html">releases/v0.9</a></dd>
        </dl>
      </div>
    </div>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygama</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">pygama</a> &raquo;</li>
          <li><a href="pygama.html">pygama package</a> &raquo;</li>
          <li><a href="pygama.dsp.html">pygama.dsp package</a> &raquo;</li>
      <li>pygama.dsp._processors package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/pygama.dsp._processors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pygama.dsp._processors">
<span id="pygama-dsp-processors-package"></span><h1>pygama.dsp._processors package<a class="headerlink" href="#module-pygama.dsp._processors" title="Permalink to this heading"></a></h1>
<p>Package documentation</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pygama.dsp._processors.bl_subtract">
<span id="pygama-dsp-processors-bl-subtract-module"></span><h2>pygama.dsp._processors.bl_subtract module<a class="headerlink" href="#module-pygama.dsp._processors.bl_subtract" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.bl_subtract.bl_subtract">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.bl_subtract.</span></span><span class="sig-name descname"><span class="pre">bl_subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.bl_subtract.bl_subtract" title="Permalink to this definition"></a></dt>
<dd><p>Subtract the constant baseline from the entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>a_baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The baseline value to subtract</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The output waveform with the baseline subtracted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bl_subtract&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.convolutions">
<span id="pygama-dsp-processors-convolutions-module"></span><h2>pygama.dsp._processors.convolutions module<a class="headerlink" href="#module-pygama.dsp._processors.convolutions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.convolutions.cusp_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">cusp_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.convolutions.cusp_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a CUSP filter to the waveform.  Note that it is composed of a
factory function that is called using the init_args argument and that
the function the waveforms are passed to using args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the filter to be convolved</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The curvature of the rising and falling part of the kernel</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the flat section</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The decay constant of the exponential to be convolved</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_cusp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cusp_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_cusp(101,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;len(wf_bl)-100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;40*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;45*us&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.convolutions.t0_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">t0_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.convolutions.t0_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a modified, asymmetric trapezoidal filter to the waveform.  Note
that it is composed of a factory function that is called using the init_args
argument and that the function the waveforms are passed to using args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the rise section.  This is the linearly increasing
section of the filter that performs a weighted average.</p></li>
<li><p><strong>fall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the fall section.  This is the simple averaging part
of the filter.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_t0_filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t0_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_t0_filter(3748,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;128*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2*us&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.convolutions.zac_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">zac_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.convolutions.zac_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a ZAC (Zero Area CUSP) filter to the waveform.  Note that it is
composed of a factory function that is called using the init_args
argument and that the function the waveforms are passed to using args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the filter to be convolved</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The curvature of the rising and falling part of the kernel</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The length of the flat section</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The decay constant of the exponential to be convolved</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_zac&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zac_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_zac(101,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;len(wf_bl)-100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;40*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;45*us&quot;</span><span class="p">],</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.fftw">
<span id="pygama-dsp-processors-fftw-module"></span><h2>pygama.dsp._processors.fftw module<a class="headerlink" href="#module-pygama.dsp._processors.fftw" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.fftw.dft">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.fftw.</span></span><span class="sig-name descname"><span class="pre">dft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.fftw.dft" title="Permalink to this definition"></a></dt>
<dd><p>Perform discrete Fourier transforms using the FFTW library.  FFTW optimizes
the FFT algorithm based on the size of the arrays, with SIMD parallelized
commands.  This optimization requires initialization, so this is a factory
function that returns a Numba gufunc that performs the FFT.  FFTW works on
fixed memory buffers, so you must tell it what memory to use ahead of time.
When using this with ProcessingChain, to ensure the correct buffers are used,
call ProcessingChain.get_variable('var_name') to give it the internal memory
buffer directly---with build_dsp, you can just give it the name, and it will
automatically happen.  The possible dtypes for the input/outputs are:
- float32/float          (size n) -&gt; complex64              (size n/2+1)
- float64/double         (size n) -&gt; complex128             (size n/2+1)
- float128/longdouble    (size n) -&gt; complex256/clongdouble (size n/2+1)
- complex64              (size n) -&gt; complex64              (size n    )
- complex128             (size n) -&gt; complex128             (size n    )
- complex256/clongdouble (size n) -&gt; complex256/clongdouble (size n    )</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.fftw.inv_dft">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.fftw.</span></span><span class="sig-name descname"><span class="pre">inv_dft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.fftw.inv_dft" title="Permalink to this definition"></a></dt>
<dd><p>Perform inverse discrete Fourier transforms using the FFTW library.  FFTW
optimizes the FFT algorithm based on the size of the arrays, with SIMD parallelized
commands.  This optimization requires initialization, so this is a factory
function that returns a Numba gufunc that performs the FFT.  FFTW works on
fixed memory buffers, so you must tell it what memory to use ahead of time.
When using this with ProcessingChain, to ensure the correct buffers are used,
call ProcessingChain.get_variable('var_name') to give it the internal memory
buffer directly---with build_dsp, you can just give it the name, and it will
automatically happen.  The possible dtypes for the input/outputs are:
- complex64              (size n/2+1) -&gt; float32/float          (size n)
- complex128             (size n/2+1) -&gt; float64/double         (size n)
- complex256/clongdouble (size n/2+1) -&gt; float128/longdouble    (size n)
- complex64              (size n    ) -&gt; complex64              (size n)
- complex128             (size n    ) -&gt; complex128             (size n)
- complex256/clongdouble (size n    ) -&gt; complex256/clongdouble (size n)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.fftw.psd">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.fftw.</span></span><span class="sig-name descname"><span class="pre">psd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.fftw.psd" title="Permalink to this definition"></a></dt>
<dd><p>Perform discrete Fourier transforms using the FFTW library, and use it to get
the power spectral density.  FFTW optimizes the FFT algorithm based on the
size of the arrays, with SIMD parallelized commands.  This optimization
requires initialization, so this is a factory function that returns a Numba gufunc
that performs the FFT.  FFTW works on fixed memory buffers, so you must
tell it what memory to use ahead of time.  When using this with ProcessingChain,
to ensure the correct buffers are used, call ProcessingChain.get_variable('var_name')
to give it the internal memory buffer directly---with build_dsp, you can just
give it the name, and it will automatically happen.  The possible dtypes for the
input/outputs are:
- complex64              (size n) -&gt; float32/float       (size n    )
- complex128             (size n) -&gt; float64/double      (size n    )
- complex256/clongdouble (size n) -&gt; float128/longdouble (size n    )
- float32/float          (size n) -&gt; float32/float       (size n/2+1)
- float64/double         (size n) -&gt; float64/double      (size n/2+1)
- float128/longdouble    (size n) -&gt; float128/longdouble (size n/2+1)</p>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.fixed_time_pickoff">
<span id="pygama-dsp-processors-fixed-time-pickoff-module"></span><h2>pygama.dsp._processors.fixed_time_pickoff module<a class="headerlink" href="#module-pygama.dsp._processors.fixed_time_pickoff" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.fixed_time_pickoff.fixed_time_pickoff">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.fixed_time_pickoff.</span></span><span class="sig-name descname"><span class="pre">fixed_time_pickoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.fixed_time_pickoff.fixed_time_pickoff" title="Permalink to this definition"></a></dt>
<dd><p>Pick off the waveform value at the provided index.  If the
provided index is out of range, return NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>t_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The waveform index to pick off</p></li>
<li><p><strong>a_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output pick-off value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;trapEftp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed_time_pickoff&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_trap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0+10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;trapEftp&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_trap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.gaussian_filter1d">
<span id="pygama-dsp-processors-gaussian-filter1d-module"></span><h2>pygama.dsp._processors.gaussian_filter1d module<a class="headerlink" href="#module-pygama.dsp._processors.gaussian_filter1d" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.gaussian_filter1d.gaussian_filter1d">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.gaussian_filter1d.</span></span><span class="sig-name descname"><span class="pre">gaussian_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.gaussian_filter1d.gaussian_filter1d" title="Permalink to this definition"></a></dt>
<dd><p>1-D Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>%</strong><strong>(</strong><strong>input</strong><strong>)</strong><strong>s</strong> -- </p></li>
<li><p><strong>sigma</strong> (<em>scalar</em>) -- standard deviation for Gaussian kernel</p></li>
<li><p><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) -- Truncate the filter at this many standard deviations.
Default is 4.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gaussian_filter1d</strong> (<em>ndarray</em>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.get_multi_local_extrema">
<span id="pygama-dsp-processors-get-multi-local-extrema-module"></span><h2>pygama.dsp._processors.get_multi_local_extrema module<a class="headerlink" href="#module-pygama.dsp._processors.get_multi_local_extrema" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.get_multi_local_extrema.get_multi_local_extrema">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.get_multi_local_extrema.</span></span><span class="sig-name descname"><span class="pre">get_multi_local_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_delta_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_max_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.get_multi_local_extrema.get_multi_local_extrema" title="Permalink to this definition"></a></dt>
<dd><p>Get lists of indices of the local maxima and minima of data
The &quot;local&quot; extrema are those maxima / minima that have heights / depths of
at least a_delta_in.
Converted from MATLAB script at: <a class="reference external" href="http://billauer.co.il/peakdet.html">http://billauer.co.il/peakdet.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The array of data within which extrema will be found</p></li>
<li><p><strong>a_delta_in</strong> (<em>scalar</em>) -- The absolute level by which data must vary (in one direction) about an
extremum in order for it to be tagged</p></li>
<li><p><strong>vt_max_out</strong> (<em>array-like</em><em>, </em><em>array-like</em>) -- Arrays of fixed length (padded with nans) that hold the indices of
the identified local maxima and minima</p></li>
<li><p><strong>vt_min_out</strong> (<em>array-like</em><em>, </em><em>array-like</em>) -- Arrays of fixed length (padded with nans) that hold the indices of
the identified local maxima and minima</p></li>
<li><p><strong>n_max_out</strong> (<em>scalar</em><em>, </em><em>scalar</em>) -- The number of maxima and minima found in a waveform</p></li>
<li><p><strong>n_min_out</strong> (<em>scalar</em><em>, </em><em>scalar</em>) -- The number of maxima and minima found in a waveform</p></li>
<li><p><strong>flag_out</strong> (<em>scalar</em>) -- Returns 1 if there is only one maximum and it is a simple waveform,
Returns 0 if there are no peaks, or multiple peaks in a waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.linear_slope_fit">
<span id="pygama-dsp-processors-linear-slope-fit-module"></span><h2>pygama.dsp._processors.linear_slope_fit module<a class="headerlink" href="#module-pygama.dsp._processors.linear_slope_fit" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.linear_slope_fit.linear_slope_fit">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.linear_slope_fit.</span></span><span class="sig-name descname"><span class="pre">linear_slope_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.linear_slope_fit.linear_slope_fit" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mean and standard deviation of the waveform using
Welford's method as well as the slope an intercept of the waveform
using linear regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The mean of the waveform</p></li>
<li><p><strong>stdev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The standard deviation of the waveform</p></li>
<li><p><strong>slope</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The slope of the linear fit</p></li>
<li><p><strong>intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The intercept of the linear fit</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;bl_mean, bl_std, bl_slope, bl_intercept&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linear_slope_fit&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub[0:1650]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_mean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_std&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_slope&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_intercept&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.log_check">
<span id="pygama-dsp-processors-log-check-module"></span><h2>pygama.dsp._processors.log_check module<a class="headerlink" href="#module-pygama.dsp._processors.log_check" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.log_check.log_check">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.log_check.</span></span><span class="sig-name descname"><span class="pre">log_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_log</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.log_check.log_check" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the logarithm of the waveform if all its values
are positive; otherwise, return NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>w_log</strong> (<em>array-like</em>) -- The output waveform with logged values</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_logged&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;log_check&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub[2100:]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_logged&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.min_max">
<span id="pygama-dsp-processors-min-max-module"></span><h2>pygama.dsp._processors.min_max module<a class="headerlink" href="#module-pygama.dsp._processors.min_max" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.min_max.min_max">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.min_max.</span></span><span class="sig-name descname"><span class="pre">min_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.min_max.min_max" title="Permalink to this definition"></a></dt>
<dd><p>Find the value and index of the minimum and maximum values
in the waveform.  Note that the first instance of each extremum
in the waveform will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>t_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The index of the minimum value</p></li>
<li><p><strong>t_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The index of the maximum value</p></li>
<li><p><strong>a_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The minimum value</p></li>
<li><p><strong>a_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The maximum value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tp_min, tp_max, wf_min, wf_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;min_max&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_min&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_max&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_min&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_max&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.moving_windows">
<span id="pygama-dsp-processors-moving-windows-module"></span><h2>pygama.dsp._processors.moving_windows module<a class="headerlink" href="#module-pygama.dsp._processors.moving_windows" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.moving_windows.avg_current">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">avg_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.moving_windows.avg_current" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the derivative of a WF, averaged across n samples. Dimension of
deriv should be len(wf) - n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Length of the moving window to be applied</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- Output waveform after derivation</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;curr&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;avg_current&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;curr(len(wf_pz)-1, f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC/sample&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.moving_windows.moving_window_left">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.moving_windows.moving_window_left" title="Permalink to this definition"></a></dt>
<dd><p>Applies a moving average window to the waveform from the left, assumes that the baseline is at 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Length of the moving window to be applied</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- Output waveform after moving window applied</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_mw&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_left&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_mw&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.moving_windows.moving_window_multi">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.moving_windows.moving_window_multi" title="Permalink to this definition"></a></dt>
<dd><p>Apply a series of moving-average windows to the waveform, alternating
its application between the left and the right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Length of the moving window to be applied</p></li>
<li><p><strong>num_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of moving windows</p></li>
<li><p><strong>mw_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- 0 = alternate moving windows right and left
1 = only left
2 = only right</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The windowed waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;curr_av&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_multi&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;curr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;curr_av&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC/sample&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;curr&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.moving_windows.moving_window_right">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.moving_windows.moving_window_right" title="Permalink to this definition"></a></dt>
<dd><p>Applies a moving average window to the waveform from the right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Length of the moving window to be applied</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- Output waveform after moving window applied</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_mw&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_right&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_mw&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.multi_a_filter">
<span id="pygama-dsp-processors-multi-a-filter-module"></span><h2>pygama.dsp._processors.multi_a_filter module<a class="headerlink" href="#module-pygama.dsp._processors.multi_a_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.multi_a_filter.multi_a_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.multi_a_filter.</span></span><span class="sig-name descname"><span class="pre">multi_a_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_maxs_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">va_max_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.multi_a_filter.multi_a_filter" title="Permalink to this definition"></a></dt>
<dd><p>Finds the maximums in a waveform and returns the amplitude of the wave at those points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The array of data within which amplitudes of extrema will be found</p></li>
<li><p><strong>vt_maxs_in</strong> (<em>array-like</em>) -- The array of max positions for each wf</p></li>
<li><p><strong>va_max_out</strong> (<em>array-like</em>) -- An array (in-place filled) of the amplitudes of the maximums of the waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.multi_t_filter">
<span id="pygama-dsp-processors-multi-t-filter-module"></span><h2>pygama.dsp._processors.multi_t_filter module<a class="headerlink" href="#module-pygama.dsp._processors.multi_t_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.multi_t_filter.multi_t_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.multi_t_filter.</span></span><span class="sig-name descname"><span class="pre">multi_t_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_threshold_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_max_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.multi_t_filter.multi_t_filter" title="Permalink to this definition"></a></dt>
<dd><p>Gets list of indices of the start of leading edges of multiple peaks within a waveform.
Is built to handle afterpulses/delayed cross talk and trains of pulses.
The multi_t_filter works by calling the vectorized functions
&quot;get_multi_local_extrema&quot; which returns a list of the maxima and minima in a waveform,
and then the list of maxima is fed into &quot;time_point_thresh&quot; which returns
the final times that waveform is less than a specified threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The array of data within which the list of tp0s will be found</p></li>
<li><p><strong>a_threshold_in</strong> (<em>scalar</em>) -- Threshold to search for using time_point_thresh</p></li>
<li><p><strong>vt_max_in</strong> (<em>array-like</em>) -- The array of max positions for each wf</p></li>
<li><p><strong>vt_min_in</strong> (<em>array-like</em>) -- The array of min positions for each wf</p></li>
<li><p><strong>t_out</strong> (<em>array-like</em>) -- Output array of fixed length (padded with nans) that hold the indices of
the identified initial rise times of peaks in the signal</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.multi_t_filter.remove_duplicates">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.multi_t_filter.</span></span><span class="sig-name descname"><span class="pre">remove_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.multi_t_filter.remove_duplicates" title="Permalink to this definition"></a></dt>
<dd><p>time_point_thresh has issues with afterpulsing in waveforms that causes an
aferpulse peak's tp0 to be sent to 0 or the same index as the tp0 for the
first pulse.  This only happens when the relative minimum between the first
pulse and the afterpulse is greater than the threshold. So, we sweep
through the array again to ensure there are no duplicate indices. If there
are duplicate indices caused by a misidentified tp0 of an afterpulse, we
replace its index by that of the corresponding minimum found using the
get_multi_local_extrema function. It also checks to make sure that the
maximum of a waveform isn't right at index 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_in</strong> (<em>array-like</em>) -- The array of indices that we want to remove duplicates from</p></li>
<li><p><strong>vt_min_in</strong> (<em>array-like</em>) -- List of indices of minima that we want to replace duplicates in t_out with</p></li>
<li><p><strong>t_out</strong> (<em>array-like</em>) -- The array we want to return that will have no duplicate indices in it</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.optimize">
<span id="pygama-dsp-processors-optimize-module"></span><h2>pygama.dsp._processors.optimize module<a class="headerlink" href="#module-pygama.dsp._processors.optimize" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygama.dsp._processors.optimize.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.optimize.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.optimize.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The model class containing the function to minimize.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.optimize.optimize_1pz">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.optimize.</span></span><span class="sig-name descname"><span class="pre">optimize_1pz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_beg_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val0_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.optimize.optimize_1pz" title="Permalink to this definition"></a></dt>
<dd><p>Find the optimal, single pole-zero cancellation's parameter
by minimizing the slope in the waveform's specified time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>a_baseline_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The resting baseline</p></li>
<li><p><strong>t_beg_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The lower bound's index for the time range over
which to optimize the pole-zero cancellation</p></li>
<li><p><strong>t_end_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The upper bound's index for the time range over
which to optimize the pole-zero cancellation</p></li>
<li><p><strong>p0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The initial guess of the optimal time constant</p></li>
<li><p><strong>val0_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output value of the best-fit time constant</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tau0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;optimize_1pz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau0&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.optimize.optimize_2pz">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.optimize.</span></span><span class="sig-name descname"><span class="pre">optimize_2pz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_beg_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val0_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val1_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val2_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.optimize.optimize_2pz" title="Permalink to this definition"></a></dt>
<dd><p>Find the optimal, double pole-zero cancellation's parameters
by minimizing the slope in the waveform's specified time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>a_baseline_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The resting baseline</p></li>
<li><p><strong>t_beg_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The lower bound's index for the time range over
which to optimize the pole-zero cancellation</p></li>
<li><p><strong>t_end_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The upper bound's index for the time range over
which to optimize the pole-zero cancellation</p></li>
<li><p><strong>p0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The initial guess of the optimal, longer time constant</p></li>
<li><p><strong>p1_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The initial guess of the optimal, shorter time constant</p></li>
<li><p><strong>p2_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The initial guess of the optimal fraction</p></li>
<li><p><strong>val0_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output value of the best-fit, longer time constant</p></li>
<li><p><strong>val1_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output value of the best-fit, shorter time constant</p></li>
<li><p><strong>val2_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output value of the best-fit fraction</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tau1, tau2, frac&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;optimize_2pz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.02&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;frac&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.param_lookup">
<span id="pygama-dsp-processors-param-lookup-module"></span><h2>pygama.dsp._processors.param_lookup module<a class="headerlink" href="#module-pygama.dsp._processors.param_lookup" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.param_lookup.param_lookup">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.param_lookup.</span></span><span class="sig-name descname"><span class="pre">param_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.param_lookup.param_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Generate the ufunc lookup(channel, val), which returns a NumPy array of
values corresponding to various channels that are looked up in the provided
param_dict.  If there is no key, use default_val instead.</p>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.pole_zero">
<span id="pygama-dsp-processors-pole-zero-module"></span><h2>pygama.dsp._processors.pole_zero module<a class="headerlink" href="#module-pygama.dsp._processors.pole_zero" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.pole_zero.double_pole_zero">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.pole_zero.</span></span><span class="sig-name descname"><span class="pre">double_pole_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.pole_zero.double_pole_zero" title="Permalink to this definition"></a></dt>
<dd><p>Apply a double pole-zero cancellation using the provided time
constants to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>t_tau1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The time constant of the first exponential to be deconvolved</p></li>
<li><p><strong>t_tau2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The time constant of the second exponential to be deconvolved</p></li>
<li><p><strong>frac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fraction which the second exponential contributes</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The pole-zero cancelled waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_pz&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;double_pole_zero&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;400*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.02&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_pz&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This algorithm is an IIR filter to deconvolve the function</p>
<div class="math notranslate nohighlight">
\[s(t) = A[frac*\exp\left(-\frac{t}{t_{tau2}}\right) + (1-frac)*\exp\left(-\frac{t}{t_{tau1}}\right)]\]</div>
<p>into a single step function of amplitude A.
This filter is derived by z-transforming the input (<span class="math notranslate nohighlight">\(s(t)\)</span>) and output (step function)
signals, and then determining the transfer function. For shorthand, define <span class="math notranslate nohighlight">\(a=\exp\left(-\frac{1}{t_{tau1}}\right)\)</span>
and <span class="math notranslate nohighlight">\(b=\exp\left(-\frac{1}{t_{tau2}}\right)\)</span>, the transfer function is then:</p>
<div class="math notranslate nohighlight">
\[H(z) =  \frac{1-(a+b)z^{-1}+abz^{-2}}{1+(fb-fa-b-1)z^{-1}-(fb-fa-b)z^{-2}}\]</div>
<p>By equating the transfer function to the ratio of output to input waveforms <span class="math notranslate nohighlight">\(H(z) = \frac{w_{out}(z)}{w_{in}(z)}\)</span>
and then taking the inverse z-transform yields the filter as run in the function, where f is the frac parameter:</p>
<div class="math notranslate nohighlight">
\[\begin{split}w_{out}[n] = &amp;w_{in}[n]-(a+b)w_{in}[n-1]+(ab)w_{in}[n-2]\\
&amp;-(fb-fa-b-1)w_{out}[n-1]+(fb-fa-b)w_{out}[n-2]\end{split}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.pole_zero.pole_zero">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.pole_zero.</span></span><span class="sig-name descname"><span class="pre">pole_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.pole_zero.pole_zero" title="Permalink to this definition"></a></dt>
<dd><p>Apply a pole-zero cancellation using the provided time
constant to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>t_tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The time constant of the exponential to be deconvolved</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The pole-zero cancelled waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_pz&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pole_zero&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;400*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_pz&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.presum">
<span id="pygama-dsp-processors-presum-module"></span><h2>pygama.dsp._processors.presum module<a class="headerlink" href="#module-pygama.dsp._processors.presum" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.presum.presum">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.presum.</span></span><span class="sig-name descname"><span class="pre">presum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.presum.presum" title="Permalink to this definition"></a></dt>
<dd><p>Presum the waveform.  Combine bins in chunks of len(w_in) / len(w_out),
which is hopefully an integer.  If it isn't, then some samples at the end
will be omitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The output waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.pulse_injector">
<span id="pygama-dsp-processors-pulse-injector-module"></span><h2>pygama.dsp._processors.pulse_injector module<a class="headerlink" href="#module-pygama.dsp._processors.pulse_injector" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.pulse_injector.inject_exp_pulse">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.pulse_injector.</span></span><span class="sig-name descname"><span class="pre">inject_exp_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.pulse_injector.inject_exp_pulse" title="Permalink to this definition"></a></dt>
<dd><p>Inject exponential pulse into existing waveform to simulate pileup</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.pulse_injector.inject_sig_pulse">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.pulse_injector.</span></span><span class="sig-name descname"><span class="pre">inject_sig_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.pulse_injector.inject_sig_pulse" title="Permalink to this definition"></a></dt>
<dd><p>Inject sigmoid pulse into existing waveform to simulate pileup</p>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.saturation">
<span id="pygama-dsp-processors-saturation-module"></span><h2>pygama.dsp._processors.saturation module<a class="headerlink" href="#module-pygama.dsp._processors.saturation" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.saturation.saturation">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.saturation.</span></span><span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bit_depth_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lo_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hi_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.saturation.saturation" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of samples in the waveform that are
saturated at the minimum and maximum possible values based
on the bit depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>bit_depth_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The bit depth of the analog-to-digital converter</p></li>
<li><p><strong>n_lo_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The output number of samples at the minimum</p></li>
<li><p><strong>n_hi_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The output number of samples at the maximum</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;sat_lo, sat_hi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;saturation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;16&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sat_lo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sat_hi&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.soft_pileup_corr">
<span id="pygama-dsp-processors-soft-pileup-corr-module"></span><h2>pygama.dsp._processors.soft_pileup_corr module<a class="headerlink" href="#module-pygama.dsp._processors.soft_pileup_corr" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.soft_pileup_corr.soft_pileup_corr">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.soft_pileup_corr.</span></span><span class="sig-name descname"><span class="pre">soft_pileup_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.soft_pileup_corr.soft_pileup_corr" title="Permalink to this definition"></a></dt>
<dd><p>Fit the baseline to an exponential with the provided time
constant and then subtract the best-fit function from the
entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>n_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples at the beginning of the waveform
to fit to an exponential</p></li>
<li><p><strong>tau_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fixed, exponential time constant</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The output waveform with the exponential subtracted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;soft_pileup_corr&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.soft_pileup_corr.soft_pileup_corr_bl">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.soft_pileup_corr.</span></span><span class="sig-name descname"><span class="pre">soft_pileup_corr_bl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.soft_pileup_corr.soft_pileup_corr_bl" title="Permalink to this definition"></a></dt>
<dd><p>Fit the baseline to an exponential with the provided time
constant and then subtract the best-fit function from the
entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>n_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples at the beginning of the waveform
to fit to an exponential</p></li>
<li><p><strong>tau_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fixed, exponential time constant</p></li>
<li><p><strong>B_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fixed, exponential constant</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The output waveform with the exponential subtracted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;soft_pileup_corr_bl&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.time_point_thresh">
<span id="pygama-dsp-processors-time-point-thresh-module"></span><h2>pygama.dsp._processors.time_point_thresh module<a class="headerlink" href="#module-pygama.dsp._processors.time_point_thresh" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.time_point_thresh.time_point_thresh">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.time_point_thresh.</span></span><span class="sig-name descname"><span class="pre">time_point_thresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">walk_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.time_point_thresh.time_point_thresh" title="Permalink to this definition"></a></dt>
<dd><p>Find the index where the waveform value crosses the threshold,
walking either forward or backward from the starting index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>a_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The threshold value</p></li>
<li><p><strong>t_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The starting index</p></li>
<li><p><strong>walk_forward</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The backward (0) or forward (1) search direction</p></li>
<li><p><strong>t_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The index where the waveform value crosses the threshold</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tp_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;time_point_thresh&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_atrap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_std&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_start&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_atrap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_std&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_start&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.trap_filters">
<span id="pygama-dsp-processors-trap-filters-module"></span><h2>pygama.dsp._processors.trap_filters module<a class="headerlink" href="#module-pygama.dsp._processors.trap_filters" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.trap_filters.asym_trap_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">asym_trap_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.trap_filters.asym_trap_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply an asymmetric trapezoidal filter to the waveform, normalized
by the number of samples averaged in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples averaged in the rise section</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The delay between the rise and fall sections</p></li>
<li><p><strong>fall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples averaged in the fall section</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The normalized, filtered waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_af&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asym_trap_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;128*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;64*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_af&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.trap_filters.trap_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.trap_filters.trap_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a symmetric trapezoidal filter to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples averaged in the rise and fall sections</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The delay between the rise and fall sections</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The filtered waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_tf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_tf&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.trap_filters.trap_norm">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.trap_filters.trap_norm" title="Permalink to this definition"></a></dt>
<dd><p>Apply a symmetric trapezoidal filter to the waveform, normalized
by the number of samples averaged in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples averaged in the rise and fall sections</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The delay between the rise and fall sections</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The normalized, filtered waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_tf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_norm&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_tf&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.trap_filters.trap_pickoff">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_pickoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pickoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.trap_filters.trap_pickoff" title="Permalink to this definition"></a></dt>
<dd><p>Pick off the value at the provided index of a symmetric trapezoidal
filter to the input waveform, normalized by the number of samples averaged
in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples averaged in the rise and fall sections</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The delay between the rise and fall sections</p></li>
<li><p><strong>t_pickoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The waveform index to pick off</p></li>
<li><p><strong>a_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The output pick-off value of the filtered waveform</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;ct_corr&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_pickoff&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1.5*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ct_corr&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.upsampler">
<span id="pygama-dsp-processors-upsampler-module"></span><h2>pygama.dsp._processors.upsampler module<a class="headerlink" href="#module-pygama.dsp._processors.upsampler" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.upsampler.upsampler">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.upsampler.</span></span><span class="sig-name descname"><span class="pre">upsampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.upsampler.upsampler" title="Permalink to this definition"></a></dt>
<dd><p>Upsamples the waveform by the number specified,
a series of moving windows should be applied afterwards for smoothing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- waveform to upsample.</p></li>
<li><p><strong>upsample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Number of samples to increase each sample to.</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- Output array for upsampled waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.wiener_filter">
<span id="pygama-dsp-processors-wiener-filter-module"></span><h2>pygama.dsp._processors.wiener_filter module<a class="headerlink" href="#module-pygama.dsp._processors.wiener_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.wiener_filter.wiener_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.wiener_filter.</span></span><span class="sig-name descname"><span class="pre">wiener_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.wiener_filter.wiener_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a wiener filter to the waveform.</p>
<p>Note that this convolution is performed in the frequency domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_name_array</strong> (<em>string</em>) -- Array with path to an lh5 file containing the time domain version
of the superpulse in one column and noise waveform in another,
the superpulse group must be titled 'spms/processed/superpulse' and
the noise waveform must be called 'spms/processed/noise_wf'</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_wiener&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wiener_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl_fft&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_wiener(2000,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dB&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;prereqs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl_fft&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/path/to/file/wiener.lh5&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp._processors.windower">
<span id="pygama-dsp-processors-windower-module"></span><h2>pygama.dsp._processors.windower module<a class="headerlink" href="#module-pygama.dsp._processors.windower" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp._processors.windower.windower">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp._processors.windower.</span></span><span class="sig-name descname"><span class="pre">windower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp._processors.windower.windower" title="Permalink to this definition"></a></dt>
<dd><p>Return a shorter sample of the waveform, starting at the
specified index.  Note that the length of the output waveform
is determined by the length of &quot;w_out&quot; rather than an input
parameter.  If the the length of &quot;w_out&quot; plus &quot;t0_in&quot; extends
past the end of &quot;w_in&quot; or if &quot;t0_in&quot; is negative, remaining
values are padded with NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The input waveform</p></li>
<li><p><strong>t0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The starting index of the window</p></li>
<li><p><strong>w_out</strong> (<em>array-like</em>) -- The windowed waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygama.dsp.html" class="btn btn-neutral float-left" title="pygama.dsp package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygama.evt.html" class="btn btn-neutral float-right" title="pygama.evt package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, the LEGEND Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>