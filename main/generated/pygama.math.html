<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygama.math package &mdash; pygama  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygama.pargen package" href="pygama.pargen.html" />
    <link rel="prev" title="pygama.lgdo package" href="pygama.lgdo.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pygama
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials (Jupyter notebooks)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Package API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pygama.html">pygama package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pygama.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pygama.dsp.html">pygama.dsp package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.evt.html">pygama.evt package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.flow.html">pygama.flow package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.hit.html">pygama.hit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.lgdo.html">pygama.lgdo package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pygama.math package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.pargen.html">pygama.pargen package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.raw.html">pygama.raw package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.vis.html">pygama.vis package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#module-pygama.cli">pygama.cli module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer's guide</a></li>
</ul>

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: main
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Branches</dt>
          <dd><a href="pygama.math.html">main</a></dd>
          <dd><a href="../../refactor/index.html">refactor</a></dd>
          <dd><a href="../../releases/v0.9/index.html">releases/v0.9</a></dd>
        </dl>
      </div>
    </div>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygama</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">pygama</a> &raquo;</li>
          <li><a href="pygama.html">pygama package</a> &raquo;</li>
      <li>pygama.math package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/pygama.math.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pygama.math">
<span id="pygama-math-package"></span><h1>pygama.math package<a class="headerlink" href="#module-pygama.math" title="Permalink to this heading"></a></h1>
<p>Subpackage description</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pygama.math.histogram">
<span id="pygama-math-histogram-module"></span><h2>pygama.math.histogram module<a class="headerlink" href="#module-pygama.math.histogram" title="Permalink to this heading"></a></h2>
<p>pygama convenience functions for 1D histograms.</p>
<p>1D hists in pygama require 3 things available from all implementations
of 1D histograms of numerical data in python: hist, bins, and var:
- hist: an array of histogram values
- bins: an array of bin edges
- var: an array of variances in each bin
If var is not provided, pygama assuems that the hist contains &quot;counts&quot; with
variance = counts (Poisson stats)</p>
<p>These are just convenience functions, provided for your convenience. Hopefully
they will help you if you need to do something trickier than is provided (e.g.
2D hists).</p>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.better_int_binning">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">better_int_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_hi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.better_int_binning" title="Permalink to this definition"></a></dt>
<dd><p>Get a good binning for integer data.</p>
<p>Guarantees an integer bin width.</p>
<p>At least two of x_hi, dx, or n_bins must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_lo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Desired low x value for the binning</p></li>
<li><p><strong>x_hi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Desired high x value for the binning</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Desired bin width</p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- Desired number of bins</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_lo</strong> (<em>int</em>) -- int values for best x_lo</p></li>
<li><p><strong>x_hi</strong> (<em>int</em>) -- int values for best x_hi, returned if x_hi is not None</p></li>
<li><p><strong>dx</strong> (<em>int</em>) -- best int bin width, returned if arg dx is not None</p></li>
<li><p><strong>n_bins</strong> (<em>int</em>) -- best int n_bins, returned if arg n_bins is not None</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.find_bin">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">find_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.find_bin" title="Permalink to this definition"></a></dt>
<dd><p>Returns the index of the bin containing x
Returns -1 for underflow, and len(bins) for overflow
For uniform bins, jumps directly to the appropriate index.
For non-uniform bins, binary search is used.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_bin_centers">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_bin_centers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_bin_centers" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array of bin centers from an input array of bin edges.
Works for non-uniform binning. Note: a new array is allocated</p>
<p>Parameters:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_bin_widths">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_bin_widths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_bin_widths" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array of bin widths from an input array of bin edges.
Works for non-uniform binning.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_fwfm">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_fwfm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fraction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bins_over_f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_fwfm" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the full width at some fraction of the max of data in a histogram</p>
<p>Typically used by sending slices around a peak. Searches about argmax(hist)
for the peak to fall by [fraction] from mx to bl</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fractional amplitude at which to evaluate the full width</p></li>
<li><p><strong>hist</strong> (<em>array-like</em>) -- The histogram data array containing the peak</p></li>
<li><p><strong>bins</strong> (<em>array-like</em>) -- An array of bin edges for the histogram</p></li>
<li><p><strong>var</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) -- An array of histogram variances. Used with the 'fit_slopes' method</p></li>
<li><p><strong>mx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>) </em><em>(</em><em>optional</em><em>)</em>) -- The value to use for the max of the peak. If None, np.amax(hist) is
used.</p></li>
<li><p><strong>dmx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) -- The uncertainty in mx</p></li>
<li><p><strong>bl</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>) </em><em>(</em><em>optional</em><em>)</em>) -- Used to specify an offset from which to estimate the FWFM.</p></li>
<li><p><strong>dbl</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) -- The uncertainty in the bl</p></li>
<li><p><strong>method</strong> (<em>string</em>) -- <dl class="simple">
<dt>'bins_over_f'<span class="classifier">the simplest method: just take the difference in the bin</span></dt><dd><p>centers that are over [fraction] of max. Only works for high stats and
FWFM/bin_width &gt;&gt; 1</p>
</dd>
<dt>'interpolate'<span class="classifier">interpolate between the bins that cross the [fration]</span></dt><dd><p>line.  Works well for high stats and a reasonable number of bins.
Uncertainty incorporates var, if provided.</p>
</dd>
<dt>'fit_slopes'<span class="classifier">fit over n_slope bins in the vicinity of the FWFM and</span></dt><dd><p>interpolate to get the fractional crossing point. Works okay even
when stats are moderate but requires enough bins that dx traversed
by n_slope bins is approximately linear. Incorporates bin variances
in fit and final uncertainties if provided.</p>
</dd>
</dl>
</p></li>
<li><p><strong>n_slope</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- DOCME</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fwfm, dfwfm</strong> (<em>float, float</em>) -- fwfm: the full width at [fraction] of the maximum above bl
dfwfm: the uncertainty in fwfm</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygama.analysis.histograms</span> <span class="k">as</span> <span class="nn">pgh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">pgh</span><span class="o">.</span><span class="n">get_hist</span><span class="p">(</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgh</span><span class="o">.</span><span class="n">get_fwfm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bins_over_f&#39;</span><span class="p">)</span>
<span class="go">(2.2, 0.15919638684132664) # may vary</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pgh</span><span class="o">.</span><span class="n">get_fwfm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;interpolate&#39;</span><span class="p">)</span>
<span class="go">(2.2041666666666666, 0.09790931254396479) # may vary</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pgh</span><span class="o">.</span><span class="n">get_fwfm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fit_slopes&#39;</span><span class="p">)</span>
<span class="go">(2.3083363869003466, 0.10939486522749278) # may vary</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_fwhm">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bins_over_f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_fwhm" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the FWHM of data in a histogram</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pygama.math.histogram.get_fwfm" title="pygama.math.histogram.get_fwfm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fwfm</span></code></a></dt><dd><p>for parameters and return values</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_gaussian_guess">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_gaussian_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_gaussian_guess" title="Permalink to this definition"></a></dt>
<dd><p>given a hist, gives guesses for mu, sigma, and amplitude</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.get_hist">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">get_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.get_hist" title="Permalink to this definition"></a></dt>
<dd><p>return hist, bins, var after binning data</p>
<p>This is just a wrapper for numpy.histogram, with optional weights for each
element and proper computing of variances.</p>
<p>Note: there are no overflow / underflow bins.</p>
<p>Available binning methods:</p>
<blockquote>
<div><ul class="simple">
<li><p>Default (no binning arguments) : 100 bins over an auto-detected range</p></li>
<li><p>bins=N, range=(x_lo, x_hi) : N bins over the specified range (or leave
range=None for auto-detected range)</p></li>
<li><p>bins=[str] : use one of np.histogram's automatic binning algorithms</p></li>
<li><p>bins=bin_edges_array : array lower bin edges, supports non-uniform binning</p></li>
<li><p>dx=dx, range=(x_lo, x_hi): bins of width dx over the specified range.
Note: dx overrides the bins argument!</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array like</em>) -- The array of data to be histogrammed</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>array</em><em>, or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) -- int: the number of bins to be used in the histogram
array: an array of bin edges to use
str: the name of the np.histogram automatic binning algorithm to use
If not provided, np.histogram's default auto-binning routine is used</p></li>
<li><p><strong>range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>) </em><em>(</em><em>optional</em><em>)</em>) -- (x_lo, x_high) is the tuple of low and high x values to uses for the
very ends of the bin range. If not provided, np.histogram chooses the
ends based on the data in data</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) -- Specifies the bin width. Overrides &quot;bins&quot; if both arguments are present</p></li>
<li><p><strong>wts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><em>array like</em><em> (</em><em>optional</em><em>)</em>) -- Array of weights for each bin. For example, if you want to divide all
bins by a time T to get the bin contents in count rate, set wts = 1/T.
Variances will be computed for each bin that appropriately account for
each data point's weighting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hist</strong> (<em>array</em>) -- the values in each bin of the histogram</p></li>
<li><p><strong>bins</strong> (<em>array</em>) -- an array of bin edges: bins[i] is the lower edge of the ith bin.
Note: it includes the upper edge of the last bin and does not
include underflow or overflow bins. So len(bins) = len(hist) + 1</p></li>
<li><p><strong>var</strong> (<em>array</em>) -- array of variances in each bin of the histogram</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.plot_hist">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">plot_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats_hloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats_vloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillalpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.plot_hist" title="Permalink to this definition"></a></dt>
<dd><p>plot a step histogram, with optional error bars</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.histogram.range_slice">
<span class="sig-prename descclassname"><span class="pre">pygama.math.histogram.</span></span><span class="sig-name descname"><span class="pre">range_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.histogram.range_slice" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pygama.math.peak_fitting">
<span id="pygama-math-peak-fitting-module"></span><h2>pygama.math.peak_fitting module<a class="headerlink" href="#module-pygama.math.peak_fitting" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.Am_double">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">Am_double</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.Am_double" title="Permalink to this definition"></a></dt>
<dd><p>A Fit function exclusevly for a 241Am 99keV and 103keV lines situation
Consists of</p>
<blockquote>
<div><ul class="simple">
<li><p>three gaussian peaks (two lines + one bkg line in between)</p></li>
<li><p>two steps (for the two lines)</p></li>
<li><p>two tails (for the two lines)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.cal_slope">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">cal_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.cal_slope" title="Permalink to this definition"></a></dt>
<dd><p>Fit the calibration values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.double_gauss_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">double_gauss_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.double_gauss_pdf" title="Permalink to this definition"></a></dt>
<dd><p>A Fit function exclusevly for a 133Ba 81keV peak situation
Consists of</p>
<blockquote>
<div><ul class="simple">
<li><p>two gaussian peaks (two lines)</p></li>
<li><p>one step</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.extended_Am_double">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">extended_Am_double</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.extended_Am_double" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.extended_double_gauss_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">extended_double_gauss_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.extended_double_gauss_pdf" title="Permalink to this definition"></a></dt>
<dd><p>A Fit function exclusevly for a 133Ba 81keV peak situation
Consists of</p>
<blockquote>
<div><ul class="simple">
<li><p>two gaussian peaks (two lines)</p></li>
<li><p>one step</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.extended_gauss_step_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">extended_gauss_step_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.extended_gauss_step_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Pdf for Gaussian on step background for Compton spectrum, returns also the total number of events for extended unbinned fits
args: n_sig mu, sigma for the signal and n_bkg, hstep for the background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.extended_radford_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">extended_radford_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.extended_radford_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Pdf for gaussian with tail signal and step background, also returns number of events</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.fit_binned">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">fit_binned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.fit_binned" title="Permalink to this definition"></a></dt>
<dd><p>Do a binned fit to a histogram.</p>
<p>Default is Extended Log Likelihood fit, with option for either Least
Squares or other cost function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>the function to fit</em><em>, </em><em>if using LL as method needs to be a cdf</em>) -- </p></li>
<li><p><strong>hist</strong> (<em>histogrammed data</em>) -- </p></li>
<li><p><strong>bins</strong> (<em>histogrammed data</em>) -- </p></li>
<li><p><strong>var</strong> (<em>histogrammed data</em>) -- </p></li>
<li><p><strong>guess</strong> (<em>initial guess parameters</em>) -- </p></li>
<li><p><strong>cost_func</strong> (<em>cost function to use</em>) -- </p></li>
<li><p><strong>Extended</strong> (<em>run extended</em><em> or </em><em>non extended fit</em>) -- </p></li>
<li><p><strong>simplex</strong> (<em>whether to include a round of simpson minimisation before main minimisation</em>) -- </p></li>
<li><p><strong>bounds</strong> (<em>list of tuples with bounds can be None</em><em>, </em><em>e.g.</em><em> [</em><em>(</em><em>0</em><em>,</em><em>None</em><em>)</em><em>, </em><em>(</em><em>0</em><em>,</em><em>10</em><em>)</em><em>]</em>) -- </p></li>
<li><p><strong>fixed</strong> (<em>list of parameter indices to fix</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>coeff</strong> (<em>array</em>)</p></li>
<li><p><strong>error</strong> (<em>array</em>)</p></li>
<li><p><strong>cov_matrix</strong> (<em>array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.fit_hist">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">fit_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poissonLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.fit_hist" title="Permalink to this definition"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.8: </span>Replaced by <a class="reference internal" href="#pygama.math.peak_fitting.fit_binned" title="pygama.math.peak_fitting.fit_binned"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_binned()</span></code></a>. Will be removed in future releases.</p>
</div>
<p>do a binned fit to a histogram (nonlinear least squares).
can either do a poisson log-likelihood fit (jason's favourite) or
use curve_fit w/ an arbitrary function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> -- function to be fitted</p></li>
<li><p><strong>hist</strong> -- as in return value of pygama.histograms.get_hist()</p></li>
<li><p><strong>bins</strong> -- as in return value of pygama.histograms.get_hist()</p></li>
<li><p><strong>var</strong> -- as in return value of pygama.histograms.get_hist()</p></li>
<li><p><strong>guess</strong> -- initial parameter guesses. Should be optional -- we can auto-guess for
many common functions. But not yet implemented.</p></li>
<li><p><strong>poissonLL</strong> -- use Poisson stats instead of the Gaussian approximation in each bin.
Requires integer stats. You must use parameter bounds to make sure that
func does not go negative over the x-range of the histogram.</p></li>
<li><p><strong>integral</strong> -- DOCME</p></li>
<li><p><strong>method</strong> -- options to pass to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.8.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a></p></li>
<li><p><strong>bounds</strong> -- options to pass to <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.8.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coeff, cov_matrix</strong> (<em>tuple(array, matrix)</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.fit_unbinned">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">fit_unbinned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.fit_unbinned" title="Permalink to this definition"></a></dt>
<dd><p>Do a unbinned fit to data.
Default is Extended Log Likelihood fit, with option for other cost functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>the function to fit</em>) -- </p></li>
<li><p><strong>data</strong> (<em>the data</em>) -- </p></li>
<li><p><strong>guess</strong> (<em>initial guess parameters</em>) -- </p></li>
<li><p><strong>Extended</strong> (<em>run extended</em><em> or </em><em>non extended fit</em>) -- </p></li>
<li><p><strong>cost_func</strong> (<em>cost function to use</em>) -- </p></li>
<li><p><strong>simplex</strong> (<em>whether to include a round of simpson minimisation before main minimisation</em>) -- </p></li>
<li><p><strong>bounds</strong> (<em>list of tuples with bounds can be None</em><em>, </em><em>e.g.</em><em> [</em><em>(</em><em>0</em><em>,</em><em>None</em><em>)</em><em>, </em><em>(</em><em>0</em><em>,</em><em>10</em><em>)</em><em>]</em>) -- </p></li>
<li><p><strong>fixed</strong> (<em>list of parameter indices to fix</em>) -- </p></li>
<li><p><strong>coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>(</em><em>array</em><em>, </em><em>matrix</em><em>)</em>) -- </p></li>
<li><p><strong>cov_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>(</em><em>array</em><em>, </em><em>matrix</em><em>)</em>) -- </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian, unnormalised for use in building pdfs, w/ args: mu, sigma.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_amp">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_amp" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian with height as a parameter for fwhm etc. args mu sigma, amplitude</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_cdf" title="Permalink to this definition"></a></dt>
<dd><p>gaussian cdf, w/ args: mu, sigma.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_linear">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_linear" title="Permalink to this definition"></a></dt>
<dd><p>gaussian signal + linear background function
args: n_sig mu, sigma for the signal and n_bkg,b,m for the background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_mode_max">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_mode_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poissonLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inflate_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gof_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_mode_max" title="Permalink to this definition"></a></dt>
<dd><p>Alias for gauss_mode_width_max that just returns the max and mode</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygama.math.peak_fitting.gauss_mode_width_max" title="pygama.math.peak_fitting.gauss_mode_width_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gauss_mode_width_max</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>pars</strong> (<em>2-tuple with the parameters (mode, maximum) of the gaussian fit</em>) -- mode : the estimated x-position of the maximum
maximum : the estimated maximum value of the peak</p></li>
<li><p><strong>cov</strong> (<em>2x2 matrix of floats</em>) -- The covariance matrix for the 2 parameters in pars</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygama.analysis.histograms</span> <span class="k">as</span> <span class="nn">pgh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygama.analysis.peak_fitting</span> <span class="k">as</span> <span class="nn">pgf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">pgh</span><span class="o">.</span><span class="n">get_hist</span><span class="p">(</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgf</span><span class="o">.</span><span class="n">gauss_mode_max</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_mode_width_max">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_mode_width_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Least</span> <span class="pre">Squares'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inflate_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gof_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_mode_width_max" title="Permalink to this definition"></a></dt>
<dd><p>Get the max, mode, and width of a peak based on gauss fit near the max
Returns the parameters of a gaussian fit over n_bins in the vicinity of the
maximum of the hist (or the max near mode_guess, if provided). This is
equivalent to a Taylor expansion around the peak maximum because near its
maximum a Gaussian can be approximated by a 2nd-order polynomial in x:</p>
<div class="math notranslate nohighlight">
\[A \exp[ -(x-\mu)^2 / 2 \sigma^2 ]
\simeq A [ 1 - (x-\mu)^2 / 2 \sigma^2 ]
= A - (1/2!) (A/\sigma^2) (x-\mu)^2\]</div>
<p>The advantage of using a gaussian over a polynomial directly is that the
gaussian parameters are the ones we care about most for a peak, whereas for
a poly we would have to extract them after the fit, accounting for
covariances. The gaussian also better approximates most peaks farther down
the peak. However, the gauss fit is nonlinear and thus less stable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<em>array-like</em>) -- The values of the histogram to be fit</p></li>
<li><p><strong>bins</strong> (<em>array-like</em>) -- The bin edges of the histogram to be fit</p></li>
<li><p><strong>var</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) -- The variances of the histogram values. If not provided, square-root
variances are assumed.</p></li>
<li><p><strong>mode_guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) -- An x-value (not a bin index!) near which a peak is expected. The
algorithm fits around the maximum within +/- n_bins of the guess. If not
provided, the center of the max bin of the histogram is used.</p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) -- The number of bins (including the max bin) to be used in the fit. Also
used for searching for a max near mode_guess</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) -- Passed to fit_binned()</p></li>
<li><p><strong>inflate_errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) -- If true, the parameter uncertainties are inflated by sqrt(chi2red)
if it is greater than 1</p></li>
<li><p><strong>gof_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) -- method flag for goodness_of_fit</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pars</strong> (<em>3-tuple containing the parameters (mode, sigma, maximum) of the</em>) -- gaussian fit</p>
<ul>
<li><p>mode : the estimated x-position of the maximum</p></li>
<li><p>sigma : the estimated width of the peak. Equivalent to a gaussian
width (sigma), but based only on the curvature within n_bins of
the peak.  Note that the Taylor-approxiamted curvature of the
underlying function in the vicinity of the max is given by max /
sigma^2</p></li>
<li><p>maximum : the estimated maximum value of the peak</p></li>
</ul>
</li>
<li><p><strong>cov</strong> (<em>3x3 matrix of floats</em>) -- The covariance matrix for the 3 parameters in pars</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_norm">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_norm" title="Permalink to this definition"></a></dt>
<dd><p>Normalised Gaussian, w/ args: mu, sigma.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Basic Gaussian pdf args; mu, sigma, n_sig (number of signal events)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_step_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_step_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_step_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Cdf for Gaussian on step background
args: n_sig mu, sigma for the signal and n_bkg,hstep for the background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_step_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_step_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_step_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Pdf for Gaussian on step background
args: n_sig mu, sigma for the signal and n_bkg,hstep for the background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_approx">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_approx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_cdf" title="Permalink to this definition"></a></dt>
<dd><p>CDF for gaussian tail</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_exact">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_exact" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_integral">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_integral" title="Permalink to this definition"></a></dt>
<dd><p>Integral for gaussian tail</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_norm">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_norm" title="Permalink to this definition"></a></dt>
<dd><p>Normalised gauss tail. Note: this is only needed when the fitting range
does not include the whole tail</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_tail_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_tail_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_tail_pdf" title="Permalink to this definition"></a></dt>
<dd><p>A gaussian tail function template
Can be used as a component of other fit functions w/args mu,sigma,tau</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_uniform">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_uniform" title="Permalink to this definition"></a></dt>
<dd><p>define a gaussian signal on a uniform background,
args: n_sig mu, sigma for the signal and n_bkg for the background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_with_tail_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_with_tail_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_with_tail_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Cdf for gaussian with tail</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.gauss_with_tail_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">gauss_with_tail_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.gauss_with_tail_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Pdf for gaussian with tail</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.get_bin_estimates">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">get_bin_estimates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.get_bin_estimates" title="Permalink to this definition"></a></dt>
<dd><p>Bin expected means are estimated by f(bin_center)*bin_width. Supply an
integrating function to compute the integral over the bin instead.
TODO: make default integrating function a numerical method that is off by
default.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.get_fwhm_func">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">get_fwhm_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.get_fwhm_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.get_mu_func">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">get_mu_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.get_mu_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.get_total_events_func">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">get_total_events_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.get_total_events_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.goodness_of_fit">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">goodness_of_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.goodness_of_fit" title="Permalink to this definition"></a></dt>
<dd><p>Compute chisq and dof of fit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<em>array</em><em>, </em><em>array</em><em>, </em><em>array</em><em> or </em><em>None</em>) -- histogram data. var can be None if hist is integer counts</p></li>
<li><p><strong>bins</strong> (<em>array</em><em>, </em><em>array</em><em>, </em><em>array</em><em> or </em><em>None</em>) -- histogram data. var can be None if hist is integer counts</p></li>
<li><p><strong>var</strong> (<em>array</em><em>, </em><em>array</em><em>, </em><em>array</em><em> or </em><em>None</em>) -- histogram data. var can be None if hist is integer counts</p></li>
<li><p><strong>func</strong> (<em>function</em>) -- the function that was fit to the hist</p></li>
<li><p><strong>pars</strong> (<em>array</em>) -- the best-fit pars of func. Assumes all pars are free parameters</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- Sets the choice of &quot;denominator&quot; in the chi2 sum
'var': user passes in the variances in var (must not have zeros)
'Pearson': use func (hist must contain integer counts)
'Neyman': use hist (hist must contain integer counts and no zeros)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>chisq</strong> (<em>float</em>) -- the summed up value of chisquared</p></li>
<li><p><strong>dof</strong> (<em>int</em>) -- the number of degrees of freedom</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.nb_erf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">nb_erf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.nb_erf" title="Permalink to this definition"></a></dt>
<dd><p>Numba version of error function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.nb_erfc">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">nb_erfc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.nb_erfc" title="Permalink to this definition"></a></dt>
<dd><p>Numba version of complementary error function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.poisson_gof">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">poisson_gof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.poisson_gof" title="Permalink to this definition"></a></dt>
<dd><p>The Poisson likelihood does not give a good GOF until the counts are very
high and all the poisson stats are roughly gaussian and you don't need it
anyway. But the G.O.F. is calculable for the Poisson likelihood. So we do
it here.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.poly">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.poly" title="Permalink to this definition"></a></dt>
<dd><p>A polynomial function with pars following the polyfit convention</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.radford_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">radford_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.radford_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Cdf for gaussian with tail signal and step background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.radford_fwhm">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">radford_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.radford_fwhm" title="Permalink to this definition"></a></dt>
<dd><p>Return the FWHM of the radford_peak function, ignoring background and step
components. If calculating error also need the normalisation for the step
function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.radford_parameter_gradient">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">radford_parameter_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.radford_parameter_gradient" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.radford_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">radford_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">htail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bkg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.radford_pdf" title="Permalink to this definition"></a></dt>
<dd><p>David Radford's HPGe peak shape PDF consists of a gaussian with tail signal
on a step background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.radford_peakshape_derivative">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">radford_peakshape_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.radford_peakshape_derivative" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.step_cdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">step_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.step_cdf" title="Permalink to this definition"></a></dt>
<dd><p>CDF for step function w/args mu, sigma, hstep</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.step_int">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">step_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.step_int" title="Permalink to this definition"></a></dt>
<dd><p>Integral of step function w/args mu, sigma, hstep</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.step_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">step_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.step_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Normalised step function w/args mu, sigma, hstep
Can be used as a component of other fit functions</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.taylor_mode_max">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">taylor_mode_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poissonLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.taylor_mode_max" title="Permalink to this definition"></a></dt>
<dd><p>Get the max and mode of a peak based on Taylor exp near the max
Returns the amplitude and position of a peak based on a poly fit over n_bins
in the vicinity of the maximum of the hist (or the max near mode_guess, if provided)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<em>array-like</em>) -- The values of the histogram to be fit. Often: send in a slice around a peak</p></li>
<li><p><strong>bins</strong> (<em>array-like</em>) -- The bin edges of the histogram to be fit</p></li>
<li><p><strong>var</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) -- The variances of the histogram values. If not provided, square-root
variances are assumed.</p></li>
<li><p><strong>mode_guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) -- An x-value (not a bin index!) near which a peak is expected. The
algorithm fits around the maximum within +/- n_bins of the guess. If not
provided, the center of the max bin of the histogram is used.</p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of bins (including the max bin) to be used in the fit. Also
used for searching for a max near mode_guess</p></li>
<li><p><strong>poissonLL</strong> -- DOCME</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pars</strong> (<em>2-tuple with the parameters (mode, max) of the fit</em>) -- mode : the estimated x-position of the maximum
maximum : the estimated maximum value of the peak</p></li>
<li><p><strong>cov</strong> (<em>2x2 matrix of floats</em>) -- The covariance matrix for the 2 parameters in pars</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygama.analysis.histograms</span> <span class="k">as</span> <span class="nn">pgh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygama.analysis.peak_fitting</span> <span class="k">as</span> <span class="nn">pgf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">pgh</span><span class="o">.</span><span class="n">get_hist</span><span class="p">(</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgf</span><span class="o">.</span><span class="n">taylor_mode_max</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.unnorm_step_pdf">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">unnorm_step_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hstep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.unnorm_step_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Unnormalised step function for use in pdfs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.peak_fitting.xtalball">
<span class="sig-prename descclassname"><span class="pre">pygama.math.peak_fitting.</span></span><span class="sig-name descname"><span class="pre">xtalball</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.peak_fitting.xtalball" title="Permalink to this definition"></a></dt>
<dd><p>power-law tail plus gaussian <a class="reference external" href="https://en.wikipedia.org/wiki/Crystal_Ball_function">https://en.wikipedia.org/wiki/Crystal_Ball_function</a></p>
</dd></dl>

</section>
<section id="module-pygama.math.units">
<span id="pygama-math-units-module"></span><h2>pygama.math.units module<a class="headerlink" href="#module-pygama.math.units" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pygama.math.utils">
<span id="pygama-math-utils-module"></span><h2>pygama.math.utils module<a class="headerlink" href="#module-pygama.math.utils" title="Permalink to this heading"></a></h2>
<p>pygama convenience functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.fit_simple_scaling">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">fit_simple_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.fit_simple_scaling" title="Permalink to this definition"></a></dt>
<dd><p>Fast computation of weighted linear least squares fit to a simple scaling</p>
<p>I.e. y = scale * x. Returns the best fit scale parameter and its variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array like</em>) -- x values for the fit</p></li>
<li><p><strong>y</strong> (<em>array like</em>) -- y values for the fit</p></li>
<li><p><strong>var</strong> (<em>array like</em><em> (</em><em>optional</em><em>)</em>) -- The variances for each y-value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scale, scale_var</strong> (<em>tuple (float, float)</em>) -- The scale parameter and its variance</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.get_dataset_from_cmdline">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">get_dataset_from_cmdline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_db</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.get_dataset_from_cmdline" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>make it easier to call this from argparse:</dt><dd><p>arg(&quot;-ds&quot;, nargs='*', action=&quot;store&quot;, help=&quot;load runs for a DS&quot;)
arg(&quot;-r&quot;, &quot;--run&quot;, nargs=1, help=&quot;load a single run&quot;)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.get_formatted_stats">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">get_formatted_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.get_formatted_stats" title="Permalink to this definition"></a></dt>
<dd><p>convenience function for formatting mean +/- sigma to the right number of
significant figures.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.get_par_names">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">get_par_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.get_par_names" title="Permalink to this definition"></a></dt>
<dd><p>Return a list containing the names of the arguments of &quot;func&quot; other than the
first argument. In pygamaland, those are the function's &quot;parameters.&quot;</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.linear_fit_by_sums">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">linear_fit_by_sums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.linear_fit_by_sums" title="Permalink to this definition"></a></dt>
<dd><p>Fast computation of weighted linear least squares fit to a linear model</p>
<p>Note: doesn't compute covariances. If you want covariances, just use polyfit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array like</em>) -- x values for the fit</p></li>
<li><p><strong>y</strong> (<em>array like</em>) -- y values for the fit</p></li>
<li><p><strong>var</strong> (<em>array like</em><em> (</em><em>optional</em><em>)</em>) -- The variances for each y-value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>(m, b)</strong> (<em>tuple (float, float)</em>) -- The slope (m) and y-intercept (b) of the best fit (in the least-squares
sense) of the data to y = mx + b</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.peakdet">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">peakdet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.peakdet" title="Permalink to this definition"></a></dt>
<dd><p>Converted from MATLAB script at: <a class="reference external" href="http://billauer.co.il/peakdet.html">http://billauer.co.il/peakdet.html</a>
Returns two arrays: [maxtab, mintab] = peakdet(v, delta, x)
An updated (vectorized) version is in pygama.dsp.transforms.peakdet</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.plot_func">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">plot_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.plot_func" title="Permalink to this definition"></a></dt>
<dd><p>plot a function.  take care of the x-axis points automatically, or user can
specify via range and npx arguments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.print_fit_results">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">print_fit_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.print_fit_results" title="Permalink to this definition"></a></dt>
<dd><p>convenience function for scipy.optimize.curve_fit results</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.set_plot_style">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">set_plot_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">style</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.set_plot_style" title="Permalink to this definition"></a></dt>
<dd><p>Choose a pygama plot style.
Current options: 'clint', 'root'
Or add your own [label].mpl file in the pygama directory!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.sh">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">sh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.sh" title="Permalink to this definition"></a></dt>
<dd><p>input a shell command as you would type it on the command line.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.sizeof_fmt">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">sizeof_fmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.sizeof_fmt" title="Permalink to this definition"></a></dt>
<dd><p>given a file size in bytes, output a human-readable form.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.math.utils.tree_draw">
<span class="sig-prename descclassname"><span class="pre">pygama.math.utils.</span></span><span class="sig-name descname"><span class="pre">tree_draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.math.utils.tree_draw" title="Permalink to this definition"></a></dt>
<dd><p>if you have to debase yourself and use ROOT, this is an easy
convenience function for quickly extracting data from TTrees.
TTree::Draw can only handle groups of 4 variables at a time,
but here we can put in as many as we want, and
return a list of numpy.ndarrays for each one</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygama.lgdo.html" class="btn btn-neutral float-left" title="pygama.lgdo package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygama.pargen.html" class="btn btn-neutral float-right" title="pygama.pargen package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, the LEGEND Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>