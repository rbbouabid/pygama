<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygama.raw package &mdash; pygama  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygama.raw.fc package" href="pygama.raw.fc.html" />
    <link rel="prev" title="pygama.pargen package" href="pygama.pargen.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pygama
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials (Jupyter notebooks)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pygama.html">Package API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pygama.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pygama.dsp.html">pygama.dsp package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.flow.html">pygama.flow package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.hit.html">pygama.hit package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.lgdo.html">pygama.lgdo package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.math.html">pygama.math package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.pargen.html">pygama.pargen package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">pygama.raw package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-pygama.raw.build_raw">pygama.raw.build_raw module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-pygama.raw.data_decoder">pygama.raw.data_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-pygama.raw.data_streamer">pygama.raw.data_streamer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-pygama.raw.raw_buffer">pygama.raw.raw_buffer module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pygama.vis.html">pygama.vis package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribution guide</a></li>
</ul>

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: refactor
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Branches</dt>
          <dd><a href="../../main/index.html">main</a></dd>
          <dd><a href="pygama.raw.html">refactor</a></dd>
          <dd><a href="../../releases/v0.9/index.html">releases/v0.9</a></dd>
        </dl>
      </div>
    </div>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygama</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="pygama.html">pygama package</a> &raquo;</li>
      <li>pygama.raw package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/pygama.raw.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pygama.raw">
<span id="pygama-raw-package"></span><h1>pygama.raw package<a class="headerlink" href="#module-pygama.raw" title="Permalink to this heading"></a></h1>
<p>The primary function for data conversion into raw lh5 files is
<a class="reference internal" href="#pygama.raw.build_raw.build_raw" title="pygama.raw.build_raw.build_raw"><code class="xref py py-func docutils literal notranslate"><span class="pre">pygama.raw.build_raw.build_raw()</span></code></a>. This is a one-to many function: one
input DAQ file can generate one or more output raw files. Control of which data
ends up in which files, and in which HDF5 groups inside of each file, is
controlled via <a class="reference internal" href="#module-pygama.raw.raw_buffer" title="pygama.raw.raw_buffer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pygama.raw.raw_buffer</span></code></a> (see below). If no raw buffers
specification is specified, all decoded data should be written to a single
output file, with all fields from each hardware decoder in their own output
table.</p>
<p>Currently we support the following hardware:</p>
<ul class="simple">
<li><p>FlashCam (requires <a class="reference external" href="https://github.com/legend-exp/pyfcutils">pyfcutils</a>)</p></li>
<li><p>SIS3302 read out with <a class="reference external" href="https://github.com/unc-enap/Orca">ORCA</a></p></li>
<li><p>GRETINA digitizer (Majorana firmware) read out with ORCA</p></li>
</ul>
<p>Partial support is in place but requires updating for</p>
<ul class="simple">
<li><p>SIS3316 read out with ORCA</p></li>
<li><p>SIS3316 read out with LLaMA-DAQ</p></li>
<li><p>CAEN DT57XX digitizers read out with CoMPASS</p></li>
</ul>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pygama.raw.fc.html">pygama.raw.fc package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.fc.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.fc.html#module-pygama.raw.fc.fc_config_decoder">pygama.raw.fc.fc_config_decoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.fc.html#module-pygama.raw.fc.fc_event_decoder">pygama.raw.fc.fc_event_decoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.fc.html#module-pygama.raw.fc.fc_status_decoder">pygama.raw.fc.fc_status_decoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.fc.html#module-pygama.raw.fc.fc_streamer">pygama.raw.fc.fc_streamer module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pygama.raw.orca.html">pygama.raw.orca package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.orca.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.orca.html#pygama-raw-orca-orca-digitizers-module">pygama.raw.orca.orca_digitizers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.orca.html#pygama-raw-orca-orca-flashcam-module">pygama.raw.orca.orca_flashcam module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.orca.html#pygama-raw-orca-orca-pollers-module">pygama.raw.orca.orca_pollers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygama.raw.orca.html#pygama-raw-orca-stream-orca-module">pygama.raw.orca.stream_orca module</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pygama.raw.build_raw">
<span id="pygama-raw-build-raw-module"></span><h2>pygama.raw.build_raw module<a class="headerlink" href="#module-pygama.raw.build_raw" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.raw.build_raw.build_raw">
<span class="sig-prename descclassname"><span class="pre">pygama.raw.build_raw.</span></span><span class="sig-name descname"><span class="pre">build_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_stream_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.build_raw.build_raw" title="Permalink to this definition"></a></dt>
<dd><p>Convert data into LEGEND hdf5 <cite>raw</cite> format.</p>
<p>Takes an input stream (in_stream) of a given type (in_stream_type) and
writes to output file(s) according to the user's a specification (out_spec).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- The name of the input stream to be converted. Typically a filename,
including path. Can use environment variables. Some streamers may be
able to (eventually) accept e.g. streaming over a port as an input.</p></li>
<li><p><strong>in_stream_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- Type of stream used to write the input file.
Options are 'ORCA', 'FlashCams', 'LlamaDaq', 'Compass', 'MGDO'</p></li>
<li><p><strong>out_spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><em>json dict</em><em> or </em><a class="reference internal" href="#pygama.raw.raw_buffer.RawBufferLibrary" title="pygama.raw.raw_buffer.RawBufferLibrary"><em>RawBufferLibrary</em></a><em> or </em><em>None</em>) -- <p>Specification for the output stream.
- If None, uses '{in_stream}.hdf5' as the output filename.
- If a str not ending in '.json', interpretted as the output filename.
- If a str ending in '.json', interpretted as a filename containing</p>
<blockquote>
<div><p>json-shorthand for the output sepcification (see raw_buffer.py)</p>
</div></blockquote>
<ul>
<li><p>If a json dict, should be a dict loaded from the json shorthand
notation for RawBufferLibraries (see raw_buffer.py), which is then
used to build a RawBufferLibrary</p></li>
<li><p>If a RawBufferLibrary, the mapping of data to output file / group is
taken from that.</p></li>
</ul>
</p></li>
<li><p><strong>buffer_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- Default size to use for data buffering</p></li>
<li><p><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- Maximum number of &quot;row&quot; of data to process from the input file</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) -- Sets whether to overwrite the output file(s) if it (they) already exist</p></li>
<li><p><strong>verbosity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- Sets the verbosity level. 0 gives the minimum output level.</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs</em>) -- Sent to RawBufferLibrary generation as kw_dict</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.raw.data_decoder">
<span id="pygama-raw-data-decoder-module"></span><h2>pygama.raw.data_decoder module<a class="headerlink" href="#module-pygama.raw.data_decoder" title="Permalink to this heading"></a></h2>
<p>data_decoder.py</p>
<p>base classe for decoding data into raw lgdo tables / files</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.raw.data_decoder.</span></span><span class="sig-name descname"><span class="pre">DataDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">garbage_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packet_size_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Decodes packets from a data stream</p>
<p>Most decoders will repeatedly decode the same set of values from each
packet.  The values that get decoded need to be described by a dict called
'decoded_values' that helps determine how to set up the buffers and write
them to file. lgdo Tables are made whose columns correspond to the elements
of decoded_values, and packet data gets pushed to the end of the table one
row at a time. See FlashCamEventDecoder or ORCAStruck3302 for an example.</p>
<p>Some decoders (like for file headers) do not need to push to a table, so they
do not need decoded_values. Such classes should still derive from
DataDecoder and define how data gets formatted into lgdo's</p>
<p>Subclasses should define a method for decoding data to a buffer like
decode_packet(packet, raw_buffer_list, packet_id, verbosity=0)
This function should return the number of bytes read</p>
<p>Garbage collection writes binary data as an array of uint32s to a
variable-length array in the output file. If a problematic packet is found,
call put_in_garbage(packet). User should set up an enum or bitbank of garbage
codes to be stored along with the garbage packets.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.buffer_is_full">
<span class="sig-name descname"><span class="pre">buffer_is_full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.buffer_is_full" title="Permalink to this definition"></a></dt>
<dd><p>Returns whether the buffer is too full to read in another packet</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.get_decoded_values">
<span class="sig-name descname"><span class="pre">get_decoded_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.get_decoded_values" title="Permalink to this definition"></a></dt>
<dd><p>Get decoded values (optionally for a given key, typically a channel)</p>
<p>Must overload for your decoder if it has key-specific decoded
values. Note: implement key = None returns a &quot;default&quot; decoded_values</p>
<p>Otherwise, just returns self.decoded_values, which should be defined in
the constructor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.get_key_list">
<span class="sig-name descname"><span class="pre">get_key_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.get_key_list" title="Permalink to this definition"></a></dt>
<dd><p>overload with list of keys for this decoder.
e.g. <cite>return range(n_channels)</cite>
The default version works for decoders with single / no keys</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.get_max_rows_in_packet">
<span class="sig-name descname"><span class="pre">get_max_rows_in_packet</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.get_max_rows_in_packet" title="Permalink to this definition"></a></dt>
<dd><p>Returns the max number of rows that could be read out in a packet</p>
<p>1 by default, overload as necessary to avoid writing past the ends of
buffers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.make_lgdo">
<span class="sig-name descname"><span class="pre">make_lgdo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.make_lgdo" title="Permalink to this definition"></a></dt>
<dd><p>Make an lgdo for this DataDecoder</p>
<p>This default version of this function allocates a Table using
the decoded_values for key. If a different type of lgdo object is
required for this decoder, overload this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>etc</em>) -- used by init_obj to initialize the lgdo for a particular key (e.g.
to have different trace lengths for different channels of a piece of
hardware). Leave as None if such specialization is not necessary</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the size to be allocated for the lgdo, if applicable</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data_obj</strong> (<em>lgdo</em>) -- the newly allocated lgdo</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.put_in_garbage">
<span class="sig-name descname"><span class="pre">put_in_garbage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packet_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.put_in_garbage" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.setup_raw_buffers">
<span class="sig-name descname"><span class="pre">setup_raw_buffers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.setup_raw_buffers" title="Permalink to this definition"></a></dt>
<dd><p>Setup raw buffers for this decoder</p>
<p>Uses the first key in a RawBuffer's key_list for initialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_decoder.DataDecoder.write_out_garbage">
<span class="sig-name descname"><span class="pre">write_out_garbage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lh5_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_decoder.DataDecoder.write_out_garbage" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pygama.raw.data_streamer">
<span id="pygama-raw-data-streamer-module"></span><h2>pygama.raw.data_streamer module<a class="headerlink" href="#module-pygama.raw.data_streamer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.raw.data_streamer.</span></span><span class="sig-name descname"><span class="pre">DataStreamer</span></span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Base clase for data streams</p>
<p>Provides a uniform interface for streaming, e.g.</p>
<p>&gt; header = ds.open_stream(stream_name)
&gt; for chunk in ds: do_something(chunk)</p>
<p>Also provides default management of the RawBufferLibrary used for data reading:
- allocation (if needed)
- configuration (to match the stream)
- fill level checking</p>
<p>Derived classes must define the functions get_decoder_list(), open_stream(),
and read_packet(); see below.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer.build_default_rb_lib">
<span class="sig-name descname"><span class="pre">build_default_rb_lib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer.build_default_rb_lib" title="Permalink to this definition"></a></dt>
<dd><p>Build the most basic RawBufferLibrary that will work for this stream.</p>
<p>A RawBufferList containing a single RawBuffer is built for each decoder
name returned by get_decoder_list. Each buffer's out_name is set to the
decoder name. The lgdo's do not get initialized.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer.get_decoder_list">
<span class="sig-name descname"><span class="pre">get_decoder_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer.get_decoder_list" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of decoder objects for this data stream.
Needs to be overloaded. Gets called during open_stream().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer.open_stream">
<span class="sig-name descname"><span class="pre">open_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb_lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'any_full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer.open_stream" title="Permalink to this definition"></a></dt>
<dd><p>Open and initialize a data stream</p>
<p>Open the stream, read in the header, set up the buffers</p>
<p>Call super().initialize([args]) from derived class after loading header
info to run this default version that sets up buffers in rb_lib using
the stream's decoders</p>
<p>Note: this default version has no actual return value! You must overload
this function, set self.n_bytes_read to the header packet size, and
return the header data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- typically a filename or e.g. a port for streaming</p></li>
<li><p><strong>rb_lib</strong> (<a class="reference internal" href="#pygama.raw.raw_buffer.RawBufferLibrary" title="pygama.raw.raw_buffer.RawBufferLibrary"><em>RawBufferLibrary</em></a>) -- A library of buffers for readout from the data stream. rb_lib will
have its lgdo's initialized during this function</p></li>
<li><p><strong>buffer_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- length of buffers to be read out in read_chunk (for buffers with
variable length)</p></li>
<li><p><strong>chunk_mode</strong> (<em>'any_full'</em><em>, </em><em>'only_full'</em><em>, or </em><em>'single_packet'</em>) -- sets the mode use for read_chunk</p></li>
<li><p><strong>out_stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- optional name of output stream for default rb_lib generation</p></li>
<li><p><strong>verbosity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- verbosity level for the initialize function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>header_data</strong> (<em>list(RawBuffer), int</em>) --</p>
<dl class="simple">
<dt>header_data is a list of RawBuffer's containing any file header</dt><dd><p>data, ready for writing to file or further processing. It's not
a RawBufferList since the buffers may have a different format</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer.read_chunk">
<span class="sig-name descname"><span class="pre">read_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_mode_override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rp_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_full_buffers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer.read_chunk" title="Permalink to this definition"></a></dt>
<dd><p>Reads a chunk of data into raw buffers</p>
<p>Reads packets until at least one buffer is too full to perform another
read.</p>
<p>Note: user is responsible for resetting / clearing the raw buffers prior
to calling read_chunk again.</p>
<p>Default version just calls read_packet() over and over. Overload as
necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk_mode_override</strong> (<em>'any_full'</em><em>, </em><em>'only_full'</em><em>, </em><em>'single_packet'</em><em>, or </em><em>None</em>) -- <p>None : do not override self.chunk_mode
'any_full' : returns all raw buffers with data as soon as any one</p>
<blockquote>
<div><p>buffer gets full</p>
</div></blockquote>
<dl class="simple">
<dt>'only_full'<span class="classifier">returns only those raw buffers that became full (or</span></dt><dd><p>nearly full) during the read. This minimizes the number of write calls.</p>
</dd>
<dt>'single_packet'<span class="classifier">returns all raw buffers with data after a single</span></dt><dd><p>read is performed. This is useful for streaming data out as soon
as it is read in (e.g. for diagnostics or in-line analysis)</p>
</dd>
</dl>
</p></li>
<li><p><strong>rp_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- maximum number of packets to read before returning anyway, even if
one of the other conditions is not met</p></li>
<li><p><strong>clear_full_buffers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) -- automatically clear any buffers that report themselves as being full
prior to reading the chunk. Set to False if clearing manually for a
minor speed-up</p></li>
<li><p><strong>verbosity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- verbosity level for the initialize function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chunk_list</strong> (<em>list of RawBuffers, int</em>) -- chunk_list is the list of RawBuffers with data ready for writing to
file or further processing. The list contains all buffers with data
or just all full buffers depending on the flag full_only.  Note
chunk_list is not a RawBufferList since the RawBuffers inside may
not all have the same structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.data_streamer.DataStreamer.read_packet">
<span class="sig-name descname"><span class="pre">read_packet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.data_streamer.DataStreamer.read_packet" title="Permalink to this definition"></a></dt>
<dd><p>Reads a single packet's worth of data in to the rb_lib</p>
<p>Needs to be overloaded. Gets called by read_chunk()</p>
<p>Needs to update self.any_full if any buffers would possibly over-fill on
the next read</p>
<p>Needs to update self.n_bytes_read too</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>still_has_data</strong> (<em>bool</em>) -- Returns true while there is still data to read</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pygama.raw.raw_buffer">
<span id="pygama-raw-raw-buffer-module"></span><h2>pygama.raw.raw_buffer module<a class="headerlink" href="#module-pygama.raw.raw_buffer" title="Permalink to this heading"></a></h2>
<p>raw_buffer.py: manages data buffering for raw data conversion</p>
<p>Manages LGDO buffers and their corresponding output streams. Allows for
one-to-many mapping of input sreams to output streams.</p>
<section id="primary-classes">
<h3>Primary Classes<a class="headerlink" href="#primary-classes" title="Permalink to this heading"></a></h3>
<p>RawBuffer: an lgdo (e.g. a table) along with buffer metadata, such as the
current write location, the list of keys (e.g. channels) that write to it, the
output stream it is associated with (if any), etc. Each data_decoder is
associated with a RawBuffer of a particular format.</p>
<p>RawBufferList: a collection of RawBuffers with lgdo's that all have the same
structure (same type, same fields, etc). A data_decoder will write its output to
a RawBufferList.</p>
<p>RawBufferLibrary: a collection (dict) of RawBufferLists, e.g. one for each
data_decoder. Keyed by the decoder name.</p>
<p>RawBuffers support a json short-hand notation, see
RawBufferLibrary.set_from_json_dict() for full specification.</p>
<p>Example json yielding a valid RawBufferLibrary is below. In the example, the
user would call RawBufferLibrary.set_from_json_dict(json_dict, kw_dict) with
kw_dict containing an entry for 'file_key'. The other keywords {key} and {name}
are understood by and filled in during set_from_json_dict() unless overloaded in
kw_dict. Note the use of the wildcard &quot;*&quot;: this will match all other decoder
names / keys.</p>
<dl>
<dt>{</dt><dd><dl>
<dt>&quot;FCEventDecoder&quot;<span class="classifier">{</span></dt><dd><dl class="simple">
<dt>&quot;g{key:0&gt;3d}&quot;<span class="classifier">{</span></dt><dd><p>&quot;key_list&quot; : [ [24,64] ],
&quot;out_stream&quot; : &quot;$DATADIR/{file_key}_geds.lh5:/geds&quot;</p>
</dd>
</dl>
<p>},
&quot;spms&quot; : {</p>
<blockquote>
<div><p>&quot;key_list&quot; : [ [6,23] ],
&quot;out_stream&quot; : &quot;$DATADIR/{file_key}_spms.lh5:/spms&quot;</p>
</div></blockquote>
<p>},
&quot;puls&quot; : {</p>
<blockquote>
<div><p>&quot;key_list&quot; : [ 0 ],
&quot;out_stream&quot; : &quot;$DATADIR/{file_key}_auxs.lh5:/auxs&quot;</p>
</div></blockquote>
<p>},
&quot;muvt&quot; : {</p>
<blockquote>
<div><p>&quot;key_list&quot; : [ 1, 5 ],
&quot;out_stream&quot; : &quot;$DATADIR/{file_key}_auxs.lh5:/auxs&quot;</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>},
&quot;*&quot; : {</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;{name}&quot;<span class="classifier">{</span></dt><dd><p>&quot;key_list&quot; : [ &quot;*&quot; ],
&quot;out_stream&quot; : &quot;$DATADIR/{file_key}_{name}.lh5&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>later: could initially make field &quot;lgdo&quot; a dict of args for lgdo.__init__(),
e.g. to have object-specific buffer sizes</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.raw.raw_buffer.</span></span><span class="sig-name descname"><span class="pre">RawBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lgdo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A RawBuffer is in essence a an lgdo object (typically a Table) to which
decoded data will be written, along with some meta-data distinguishing
what data goes into it, and where the lgdo gets written out. Also holds on
to the current location in the buffer for writing.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer.lgdo">
<span class="sig-name descname"><span class="pre">lgdo</span></span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer.lgdo" title="Permalink to this definition"></a></dt>
<dd><p>the lgdo used as the actual buffer. Typically a table. Set to None upon
creation so that the user or a decoder can initialize it later.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>lgdo</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer.key_list">
<span class="sig-name descname"><span class="pre">key_list</span></span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer.key_list" title="Permalink to this definition"></a></dt>
<dd><p>a list of keys (e.g. channel numbers) identifying data to be written
into this buffer. The key scheme is specific to the decoder with which
the RawBuffer is associated. This is called &quot;key_list&quot; instead of &quot;keys&quot;
to avoid confusion with the dict function &quot;keys()&quot;, i.e. raw_buffer.lgdo.keys()</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer.out_stream">
<span class="sig-name descname"><span class="pre">out_stream</span></span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer.out_stream" title="Permalink to this definition"></a></dt>
<dd><p>the output stream to which the raw_buffer's lgdo should be sent or
written. A colon can be used to separate the stream name/address from an
in-stream path / port:
File example: '/path/filename.lh5:/group'
Socket example: '198.0.0.100:8000'</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a> (optional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer.out_name">
<span class="sig-name descname"><span class="pre">out_name</span></span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer.out_name" title="Permalink to this definition"></a></dt>
<dd><p>the name / identifier of the object in the ouput stream</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a> (optional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBuffer.is_full">
<span class="sig-name descname"><span class="pre">is_full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBuffer.is_full" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferLibrary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.raw.raw_buffer.</span></span><span class="sig-name descname"><span class="pre">RawBufferLibrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferLibrary" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>A RawBufferLibrary is a collection of RawBufferLists associated with the
names of decoders that can write to them</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferLibrary.clear_full">
<span class="sig-name descname"><span class="pre">clear_full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferLibrary.clear_full" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferLibrary.get_list_of">
<span class="sig-name descname"><span class="pre">get_list_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferLibrary.get_list_of" title="Permalink to this definition"></a></dt>
<dd><p>Return a list of values of RawBuffer.attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- The RawBuffer attribute queried to make the list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>values</strong> (<em>list</em>) -- The list of values of RawBuffer.attribute</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>output_file_list = rbl.get_list_of('out_stream')</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferLibrary.set_from_json_dict">
<span class="sig-name descname"><span class="pre">set_from_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferLibrary.set_from_json_dict" title="Permalink to this definition"></a></dt>
<dd><p>set up a RawBufferLibrary from a dict written in json shorthand</p>
<p>Basic structure:
{
&quot;list_name&quot; : {</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;name&quot;<span class="classifier">{</span></dt><dd><p>&quot;key_list&quot; : [ key1, key2, ... ],
&quot;out_stream&quot; : &quot;out_stream_str&quot;,
&quot;out_name&quot; : &quot;out_name_str&quot; (optional)</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>
<p>By default &quot;name&quot; is used for the RawBuffer's &quot;out_name&quot; attribute, but
this can be overrided if desired by providing an explicit &quot;out_name&quot;</p>
<p>Allowed shorthands, in order of exapansion:
* key_list may have entries that are 2-integer lists corresponding to</p>
<blockquote>
<div><p>the first and last integer keys in a continguous range (e.g. of
channels) that get stored to the same buffer. These simply get
replaced with the explicit list of integers in the range. We use lists
not tuples for json compliance.</p>
</div></blockquote>
<ul class="simple">
<li><p>The &quot;name&quot; can include {key:xxx} format specifiers, indicating that
each key in key_list should be given its own buffer with the
corresponding name.  The same specifier can appear in out_path to
write the key's data to its own output path.</p></li>
<li><p>You may also include keywords in your out_stream and out_name
specification whose values get sent in via kwdict These get evaluated
simultaneously with the {key:xxx} specifiers.</p></li>
<li><p>Environment variables can also be used in out_stream. They get
expanded after kw_dict is handled and thus can be used inside kw_dict</p></li>
<li><p>list_name can use the wildcard &quot;*&quot; to match any other list_name known
to a streamer</p></li>
<li><p>out_stream and out_name can also include {name}, to be replaced with
the buffer's &quot;name&quot;. In the case of list_name=&quot;*&quot;, {name} evaluates to
list_name</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>json_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) -- dict loaded from a json file written in the allowed shorthand.
Note: json_dict is changed by this function</p></li>
<li><p><strong>kw_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) -- dict of keyword-value pairs for substitutions into the out_stream
and out_name fields</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.raw.raw_buffer.</span></span><span class="sig-name descname"><span class="pre">RawBufferList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferList" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></p>
<p>A RawBufferList holds a collection of RawBuffers of identical structure
(same format lgdo's with the same fields).</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferList.clear_full">
<span class="sig-name descname"><span class="pre">clear_full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferList.clear_full" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferList.get_keyed_dict">
<span class="sig-name descname"><span class="pre">get_keyed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferList.get_keyed_dict" title="Permalink to this definition"></a></dt>
<dd><p>returns a dict of RawBuffers built from the buffers' key_lists</p>
<p>Different keys may point to the same buffer. Requires the buffers in the
RawBufferList to have non-overlapping key lists.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferList.get_list_of">
<span class="sig-name descname"><span class="pre">get_list_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribute</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferList.get_list_of" title="Permalink to this definition"></a></dt>
<dd><p>Return a list of values of RawBuffer.attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) -- The RawBuffer attribute queried to make the list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>values</strong> (<em>list</em>) -- The list of values of RawBuffer.attribute</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>output_file_list = rbl.get_list_of('out_stream')</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.RawBufferList.set_from_json_dict">
<span class="sig-name descname"><span class="pre">set_from_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.RawBufferList.set_from_json_dict" title="Permalink to this definition"></a></dt>
<dd><p>set up a RawBufferList from a dict written in json shorthand</p>
<p>See RawBufferLibrary.set_from_json_dict() for details</p>
<p>Note: json_dict is changed by this function</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.expand_rblist_json_dict">
<span class="sig-prename descclassname"><span class="pre">pygama.raw.raw_buffer.</span></span><span class="sig-name descname"><span class="pre">expand_rblist_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.expand_rblist_json_dict" title="Permalink to this definition"></a></dt>
<dd><p>Expand shorthands in json_dict representing a RawBufferList</p>
<p>See RawBufferLibrary.set_from_json_dict() for details</p>
<p>Note: json_dict is changed by this function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.raw.raw_buffer.write_to_lh5_and_clear">
<span class="sig-prename descclassname"><span class="pre">pygama.raw.raw_buffer.</span></span><span class="sig-name descname"><span class="pre">write_to_lh5_and_clear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_buffers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lh5_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wo_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'append'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.raw.raw_buffer.write_to_lh5_and_clear" title="Permalink to this definition"></a></dt>
<dd><p>Write a list of RawBuffers to lh5 files and then clears them</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raw_buffers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>(</em><a class="reference internal" href="#pygama.raw.raw_buffer.RawBuffer" title="pygama.raw.raw_buffer.RawBuffer"><em>RawBuffer</em></a><em>)</em>) -- The list of RawBuffers to be written to file. Note this is not a
RawBufferList because the RawBuffers may not have the same structure.</p></li>
<li><p><strong>lh5_store</strong> (<a class="reference internal" href="pygama.lgdo.html#pygama.lgdo.lh5_store.LH5Store" title="pygama.lgdo.lh5_store.LH5Store"><em>LH5Store</em></a><em> or </em><em>None</em>) -- Allows user to send in a store holding a collection of already open
files (saves some time opening / closing files)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygama.pargen.html" class="btn btn-neutral float-left" title="pygama.pargen package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygama.raw.fc.html" class="btn btn-neutral float-right" title="pygama.raw.fc package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, the LEGEND Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>